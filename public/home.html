<!DOCTYPE html>
<html>
<head>
  <title>Welcome Back</title>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Login</title>

    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.14.3/firebase-app.js"></script>
    <!-- update the version number as needed -->
    <script defer src="/__/firebase/7.14.3/firebase-app.js"></script>
    <!-- include only the Firebase features as you need -->
    <script src="https://www.gstatic.com/firebasejs/7.14.3/firebase-analytics.js"></script>
    <script defer src="/__/firebase/7.14.3/firebase-auth.js"></script>
    <script defer src="/__/firebase/7.14.3/firebase-database.js"></script>
    <script defer src="/__/firebase/7.14.3/firebase-messaging.js"></script>
    <script defer src="/__/firebase/7.14.3/firebase-storage.js"></script>
    <!-- initialize the SDK after all desired features are loaded -->
    <script defer src="/__/firebase/init.js"></script>
  </head>
</head>

<body>
  <script>
      // Your web app's Firebase configuration
      var firebaseConfig = {
        apiKey: "AIzaSyCDTTKlNJXalDW0Vo3i6mun6f9xwlOeA7c",
        authDomain: "csc307project.firebaseapp.com",
        databaseURL: "https://csc307project.firebaseio.com",
        projectId: "csc307project",
        storageBucket: "csc307project.appspot.com",
        messagingSenderId: "849837058427",
        appId: "1:849837058427:web:f0bedc7d0602081905b5de",
        measurementId: "G-94B2K22TQP"
      };

      // Initialize your Web app as described in the Get started for Web
      // firebaseApp previously initialized using firebase.initializeApp().
      var db = firebaseApp.firestore();
      if (location.hostname === "localhost") {
        db.settings({
          host: "localhost:8080",
          ssl: false
        });
      }

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();

      src="/__/firebase/init.js">
  </script>

  <script>
      document.addEventListener('DOMContentLoaded', function() {

         firebase.auth().onAuthStateChanged(user => { 
          if (user) {
          }
          else {
            window.location = 'index.html';
          }});
         firebase.database().ref('/path/to/ref').on('value', snapshot => { });
         firebase.messaging().requestPermission().then(() => { });
         firebase.storage().ref('/path/to/ref').getDownloadURL().then(() => { });

        try {
          let app = firebase.app();
          let features = ['auth', 'database', 'messaging', 'storage'].filter(feature => typeof app[feature] === 'function');
          document.getElementById('load').innerHTML = `Firebase SDK loaded with ${features.join(', ')}`;
        } catch (e) {
          console.error(e);
          document.getElementById('load').innerHTML = 'Error loading the Firebase SDK, check the console.';
        }
      });
  </script>

  <script type="text/javascript">
      function signOut(){
        firebase.auth().signOut().then(function() {
          // Sign-out successful.
        }).catch(function(error) {
          // An error happened.
        });
      }

    /**
       * initApp handles setting up UI event listeners and registering Firebase auth listeners:
       *  - firebase.auth().onAuthStateChanged: This listener is called when the user is signed in or
       *    out, and that is where we update the UI.
       */
      function initApp() {
        // Listening for auth state changes.
        // [START authstatelistener]
        
        firebase.auth().onAuthStateChanged(function(user) {
          // [START_EXCLUDE silent]
          document.getElementById('quickstart-verify-email').disabled = true;
          // [END_EXCLUDE]
          if (user) {
            // User is signed in.
            var displayName = user.displayName;
            var email = user.email;
            var emailVerified = user.emailVerified;
            var photoURL = user.photoURL;
            var isAnonymous = user.isAnonymous;
            var uid = user.uid;
            var providerData = user.providerData;
            // [START_EXCLUDE]
            document.getElementById('quickstart-sign-in-status').textContent = 'Signed in';
            document.getElementById('quickstart-sign-in').textContent = 'Sign out';
            document.getElementById('quickstart-account-details').textContent = JSON.stringify(user, null, '  ');
            if (!emailVerified) {
              document.getElementById('quickstart-verify-email').disabled = false;
            }
            // [END_EXCLUDE]
          } else {
            // User is signed out.
            // [START_EXCLUDE]
            document.getElementById('quickstart-sign-in-status').textContent = 'Signed out';
            document.getElementById('quickstart-sign-in').textContent = 'Sign in';
            document.getElementById('quickstart-account-details').textContent = 'null';
            // [END_EXCLUDE]
          }
          // [START_EXCLUDE silent]
          document.getElementById('quickstart-sign-in').disabled = false;
          // [END_EXCLUDE]
        });
        // [END authstatelistener]
        //document.getElementById('quickstart-verify-email').addEventListener('click', sendEmailVerification, false);
        //document.getElementById('quickstart-password-reset').addEventListener('click', sendPasswordReset, false);
        document.getElementById('quickstart-sign-out').addEventListener('click', signOut, false);
      }

      window.onload = function() {
          initApp();
      };
  </script>
  
  <div>
    <h1> Welcome back!</h1>
    
    <button class="mdl-button mdl-js-button mdl-button--raised" id="quickstart-sign-out" name="signup">Sign Out</button>
  </div>
</body>

</html>
